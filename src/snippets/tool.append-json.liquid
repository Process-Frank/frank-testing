{%- comment -%}
  Append JSON
    Snippet to append a JSON object with more data.

  Parameters:
    jsonData - JSON String (not object) to append. If "null", will do nothing
    extra - Extra JSON to append.

  Returns:
    appended - The Appended JSON Object, or null if the source is null

  Example:
    {%- capture test -%}
      {
        "something": "lorem",
        "ipsum": { "dolor": true }
      }
    {%- endcapture -%}
    {%- capture extraTest -%}"sit": "amet"{%- endcapture -%}
    {%- include 'tool.append-json' with { jsonData: test, extra: extraTest } -%}

  Then:
    {{ appended }} will be:
    {
      "something": "lorem",
      "ipsum": { "dolor": true },
      "sit": "amet"
    }

  Version:
    1.1.0 - 2018/08/29

{%- endcomment -%}
{%- if jsonData == 'null' or extra == blank -%}
  {%- assign appended = jsonData -%}
{%- else -%}
  {%- assign jsonSplit = jsonData | split: '}' -%}
  {%- assign appended = '' -%}

  {%- for split in jsonSplit -%}
    {%- assign appended = appended | append: split -%}
    {%- unless forloop.last -%}
      {%- assign appended = appended | append: '}' -%}
    {%- endunless -%}
  {%- endfor -%}

  {%- assign appended = appended | append: ',' -%}
  {%- assign appended = appended | append: extra -%}
  {%- assign appended = appended | append: '}' -%}
{%- endif -%}
