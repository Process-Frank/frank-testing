{%- comment -%}
  Product Page Quantity Selector
    Quantity Selector for the Product Page.

  Params:
    class - (Optional) class for container.
    name - (Optional) name for the input field, defaults to "quantity"
    quantity - Default quantity (defaults to 1)
    min - Minimum possible value for the quantity selector (defaults to 0)
    max - Maximum possible value for the quantity selector (defaults to null (no max))
    isSmall - If true, use a smaller sized quantity selector (hides the input field)
    styleMinus - Style of minus button (defaults to "tertiary")
    stylePlus - Same as above but for plus


  Version:
    1.0.0 - 2019/01/21
{%- endcomment -%}

{%- comment -%} Setup Defaults {%- endcomment -%}
{%- if quantity == blank -%}{%- assign quantity = 1 -%}{%- endif -%}
{%- if min == blank -%}{%- assign min = "0" -%}{%- endif -%}
{%- if max == blank -%}{%- assign max = "null" -%}{%- endif -%}
{%- if name == blank -%}{%- assign blank = 'quantity' -%}{%- endif -%}

{%- if styleMinus == blank-%}{%- assign styleMinus = 'tertiary' -%}{%- endif -%}
{%- if stylePlus == blank-%}{%- assign stylePlus = 'tertiary' -%}{%- endif -%}

{%- comment -%} Convert string to int {%- endcomment -%}
{%- if min != "null" -%}{%- assign min = min | plus: 0 -%}{%- endif -%}
{%- if max != "null" -%}{%- assign max = max | plus: 0 -%}{%- endif -%}
{%- assign quantity = quantity | plus: 0 -%}

{%- comment -%} Enable / Disable based on state {%- endcomment -%}
{%- assign minusDisabled = false -%}
{%- assign plusDisabled = false -%}
{%- assign inputDisabled = false -%}
{%- if min != "null" and quantity <= min -%}{%- assign minusDisabled = true -%}{%- endif -%}
{%- if max != "null" and quantity >= max -%}{%- assign plusDisabled = true -%}{%- endif -%}
{%- if max != "null" and min >= max -%}{%- assign inputDisabled = true -%}{%- endif -%}

<div
  class="o-quantity-selector {% if class != blank %}{{ class }}{% endif %} {% if isSmall %}is-small{% endif %}"
  data-quantity-selector data-min="{{ min }}" data-max="{{ max }}"
>
  {%- comment -%} Minus button {%- endcomment -%}
  <button
    type="button" class="
      o-btn is-{{ styleMinus }} is-square {% if isSmall != true %}is-large{% endif %}
      o-quantity-selector__button is-minus {% if minusDisabled %}is-disabled{% endif %}
    "
    {% if minusDisabled %}disabled{% endif %} data-quantity-selector-minus
  >
    {%- include 'object.icon' with { icon: 'minus', class: 'o-btn__icon' } -%}
  </button>

  {%- comment -%} Input Field {%- endcomment -%}
  {%- if isSmall -%}
    <input
      type="hidden" value="{{ quantity }}"
      data-quantity-selector-field
      name="{{ name }}"
    />
  {%- else -%}
    <div class="o-quantity-selector__input">
      <input
        type="text" class="o-quantity-selector__input-field {% if inputDisabled %}is-disabled{% endif %}"
        value="{{ quantity }}" data-quantity-selector-field {% if inputDisabled %}disabled{% endif %}
        name="{{ name }}"
      />
    </div>
  {%- endif -%}

  {%- comment -%} Plus button {%- endcomment -%}
  <button
    type="button" class="
      o-btn is-{{ stylePlus }} is-square {% if isSmall != true %} is-large {% endif %}
      o-quantity-selector__button is-plus {% if plusDisabled %}is-disabled{% endif %}
    "
    {% if plusDisabled %}disabled{% endif %} data-quantity-selector-plus
  >
    {%- include 'object.icon' with { icon: 'plus', class: 'o-btn__icon' } -%}
  </button>
</div>
