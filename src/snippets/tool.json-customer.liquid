{%- comment -%}
  JSON Customer
    Used to fetch customer information in a nice JSON Format, does not leak
    any bad info!

    Note that this can only return the currently logged in customer.

  Parameters:
    customer - Customer to print (attached by shopify)

  Version:
    1.0.0 - 2018/08/06
{%- endcomment -%}

{% comment %} is this a JSON Template? {% endcomment %}
{%- include 'tool.is-json-template' -%}
{%- unless isJSON -%}
  <script type="text/javascript">
    window.Customer = window.Customer ||
{%- endunless -%}
  {%- comment -%}/* Is Customer Logged In */{%- endcomment -%}
  {%- if customer -%}
    {
      "accepts_marketing": {{ customer.accepts_marketing | json }},
      "addresses": [
        {%- for address in customer.addresses -%}
          {%- include 'tool.json-address' with { address: address } -%}
          {%- unless forloop.last -%},{%- endunless -%}
        {%- endfor -%}
      ],
      "address_count": {{- customer.address_count | json -}},
      "default_address": {%- include 'tool.address' with { address: customer.default_address } -%},
      "email": {{- customer.email | json -}},
      "fist_name": {{- customer.first_name | json -}},
      "has_account": {{- customer.has_account | json -}},
      "id": {{- customer.id | json -}},
      "last_name": {{- customer.last_name | json -}},
      "name": {{- customer.name | json -}},
      "last_order": {%- include 'tool.json-order' with { order: last_order } -%},
      "orders": [
        {%- for order in customer.orders -%}
          {%- include 'tool.json-order' with { order: order } -%}
          {%- unless forloop.last -%},{%- endunless -%}
        {%- endfor -%}
      ],
      "orders_count": {{- customer.orders_count -}},
      "tags": {{- customer.tags | json -}},
      "total_spent": {{- customer.total_spent | json -}}
    }
  {%- else -%}
    null
  {%- endif -%}

{%- unless isJSON -%}
;  </script>
{%- endunless -%}
